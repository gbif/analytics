DROP TABLE IF EXISTS tmp_geo_interp;

CREATE TABLE tmp_geo_interp
WITH (format = 'ORC')
AS
SELECT
  t1.geo_key,
  g.latitude,
  g.longitude,
  g.country
FROM (
  SELECT
    geo_key,
    parseGeo('/gbif/geocode-layers/', latitude, longitude, country) g
  FROM tmp_raw_geo
) t1;

Execution Time	15.40s
Execution Time	10.30s


> select count(*) from tmp_geo_interp = 22168

    Execution Time	659.98ms


** Prepared statement

PREPARE interp_geo FROM
CREATE TABLE tmp_geo_interp
WITH (format = 'ORC')
AS
SELECT
  t1.geo_key,
  g.latitude,
  g.longitude,
  g.country
FROM (
  SELECT
    geo_key,
    parseGeo('/gbif/geocode-layers/', latitude, longitude, country) g
  FROM tmp_raw_geo
) t1;

EXECUTE interp_geo;

Execution Time	15.89s
Execution Time	10.61s
